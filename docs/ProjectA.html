<!DOCTYPE html>

<html>

<head>

<meta charset="utf-8" />
<meta name="generator" content="pandoc" />
<meta http-equiv="X-UA-Compatible" content="IE=EDGE" />




<title>Project A</title>

<script src="site_libs/header-attrs-2.13/header-attrs.js"></script>
<script src="site_libs/jquery-3.6.0/jquery-3.6.0.min.js"></script>
<meta name="viewport" content="width=device-width, initial-scale=1" />
<link href="site_libs/bootstrap-3.3.5/css/bootstrap.min.css" rel="stylesheet" />
<script src="site_libs/bootstrap-3.3.5/js/bootstrap.min.js"></script>
<script src="site_libs/bootstrap-3.3.5/shim/html5shiv.min.js"></script>
<script src="site_libs/bootstrap-3.3.5/shim/respond.min.js"></script>
<style>h1 {font-size: 34px;}
       h1.title {font-size: 38px;}
       h2 {font-size: 30px;}
       h3 {font-size: 24px;}
       h4 {font-size: 18px;}
       h5 {font-size: 16px;}
       h6 {font-size: 12px;}
       code {color: inherit; background-color: rgba(0, 0, 0, 0.04);}
       pre:not([class]) { background-color: white }</style>
<script src="site_libs/navigation-1.1/tabsets.js"></script>
<link href="site_libs/highlightjs-9.12.0/default.css" rel="stylesheet" />
<script src="site_libs/highlightjs-9.12.0/highlight.js"></script>

<style type="text/css">
  code{white-space: pre-wrap;}
  span.smallcaps{font-variant: small-caps;}
  span.underline{text-decoration: underline;}
  div.column{display: inline-block; vertical-align: top; width: 50%;}
  div.hanging-indent{margin-left: 1.5em; text-indent: -1.5em;}
  ul.task-list{list-style: none;}
    </style>

<style type="text/css">code{white-space: pre;}</style>
<script type="text/javascript">
if (window.hljs) {
  hljs.configure({languages: []});
  hljs.initHighlightingOnLoad();
  if (document.readyState && document.readyState === "complete") {
    window.setTimeout(function() { hljs.initHighlighting(); }, 0);
  }
}
</script>









<style type = "text/css">
.main-container {
  max-width: 940px;
  margin-left: auto;
  margin-right: auto;
}
img {
  max-width:100%;
}
.tabbed-pane {
  padding-top: 12px;
}
.html-widget {
  margin-bottom: 20px;
}
button.code-folding-btn:focus {
  outline: none;
}
summary {
  display: list-item;
}
details > summary > p:only-child {
  display: inline;
}
pre code {
  padding: 0;
}
</style>


<style type="text/css">
.dropdown-submenu {
  position: relative;
}
.dropdown-submenu>.dropdown-menu {
  top: 0;
  left: 100%;
  margin-top: -6px;
  margin-left: -1px;
  border-radius: 0 6px 6px 6px;
}
.dropdown-submenu:hover>.dropdown-menu {
  display: block;
}
.dropdown-submenu>a:after {
  display: block;
  content: " ";
  float: right;
  width: 0;
  height: 0;
  border-color: transparent;
  border-style: solid;
  border-width: 5px 0 5px 5px;
  border-left-color: #cccccc;
  margin-top: 5px;
  margin-right: -10px;
}
.dropdown-submenu:hover>a:after {
  border-left-color: #adb5bd;
}
.dropdown-submenu.pull-left {
  float: none;
}
.dropdown-submenu.pull-left>.dropdown-menu {
  left: -100%;
  margin-left: 10px;
  border-radius: 6px 0 6px 6px;
}
</style>

<script type="text/javascript">
// manage active state of menu based on current page
$(document).ready(function () {
  // active menu anchor
  href = window.location.pathname
  href = href.substr(href.lastIndexOf('/') + 1)
  if (href === "")
    href = "index.html";
  var menuAnchor = $('a[href="' + href + '"]');

  // mark it active
  menuAnchor.tab('show');

  // if it's got a parent navbar menu mark it active as well
  menuAnchor.closest('li.dropdown').addClass('active');

  // Navbar adjustments
  var navHeight = $(".navbar").first().height() + 15;
  var style = document.createElement('style');
  var pt = "padding-top: " + navHeight + "px; ";
  var mt = "margin-top: -" + navHeight + "px; ";
  var css = "";
  // offset scroll position for anchor links (for fixed navbar)
  for (var i = 1; i <= 6; i++) {
    css += ".section h" + i + "{ " + pt + mt + "}\n";
  }
  style.innerHTML = "body {" + pt + "padding-bottom: 40px; }\n" + css;
  document.head.appendChild(style);
});
</script>

<!-- tabsets -->

<style type="text/css">
.tabset-dropdown > .nav-tabs {
  display: inline-table;
  max-height: 500px;
  min-height: 44px;
  overflow-y: auto;
  border: 1px solid #ddd;
  border-radius: 4px;
}

.tabset-dropdown > .nav-tabs > li.active:before {
  content: "";
  font-family: 'Glyphicons Halflings';
  display: inline-block;
  padding: 10px;
  border-right: 1px solid #ddd;
}

.tabset-dropdown > .nav-tabs.nav-tabs-open > li.active:before {
  content: "&#xe258;";
  border: none;
}

.tabset-dropdown > .nav-tabs.nav-tabs-open:before {
  content: "";
  font-family: 'Glyphicons Halflings';
  display: inline-block;
  padding: 10px;
  border-right: 1px solid #ddd;
}

.tabset-dropdown > .nav-tabs > li.active {
  display: block;
}

.tabset-dropdown > .nav-tabs > li > a,
.tabset-dropdown > .nav-tabs > li > a:focus,
.tabset-dropdown > .nav-tabs > li > a:hover {
  border: none;
  display: inline-block;
  border-radius: 4px;
  background-color: transparent;
}

.tabset-dropdown > .nav-tabs.nav-tabs-open > li {
  display: block;
  float: none;
}

.tabset-dropdown > .nav-tabs > li {
  display: none;
}
</style>

<!-- code folding -->




</head>

<body>


<div class="container-fluid main-container">




<div class="navbar navbar-default  navbar-fixed-top" role="navigation">
  <div class="container">
    <div class="navbar-header">
      <button type="button" class="navbar-toggle collapsed" data-toggle="collapse" data-bs-toggle="collapse" data-target="#navbar" data-bs-target="#navbar">
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
      </button>
      <a class="navbar-brand" href="index.html">Portfolio</a>
    </div>
    <div id="navbar" class="navbar-collapse collapse">
      <ul class="nav navbar-nav">
        <li>
  <a href="index.html">About me</a>
</li>
<li>
  <a href="ProjectA.html">Project A</a>
</li>
<li>
  <a href="ProjectB.html">Project B</a>
</li>
<li>
  <a href="Publications.html">Publications</a>
</li>
      </ul>
      <ul class="nav navbar-nav navbar-right">
        
      </ul>
    </div><!--/.nav-collapse -->
  </div><!--/.container -->
</div><!--/.navbar -->

<div id="header">



<h1 class="title toc-ignore">Project A</h1>

</div>


<div id="estradiol-and-testosterone-production-across-the-lifespan" class="section level2">
<h2>Estradiol and testosterone production across the lifespan</h2>
<p><img src="hormone_pic.jpeg" style="width:30.0%" /></p>
<p><font size="4">In this for-fun side project, I estimate the effects of age on estradiol and testosterone production in both males and females (and use this query as an excuse to showcase the similarities and differences between the <a href="https://cran.r-project.org/web/packages/brms/index.html">brms</a> and <a href="https://cran.r-project.org/web/packages/mgcv/index.html">mgcv</a> packages).</p>
<p>I came up with the idea for this project during the first summer I served as a mentor for the <a href="https://summer.ucsb.edu/programs/research-mentorship-program/overview">UCSB research mentorship program</a>. After chatting with my students about the biological relevance of the questions we were working on, I realized that some students were under the impression that estradiol is <em>only</em> produced by females and testosterone is <em>only</em> found in males. In addition to showing sex-specific production of both hormones, I also wanted to develop models showcasing how hormone production can vary across the entire lifespan. </font size="4"></p>
</div>
<div id="data-importing-and-cleaning" class="section level2">
<h2>Data importing and cleaning</h2>
<p><font size="4"> The complete <strong>R code</strong> for this project lives on <a href="https://github.com/carmenhove/portfolio/blob/main/ProjectA.Rmd">my GitHub repo</a>. </font size="4"></p>
<p>I utilized publicly available data collected by the <a href="https://www.cdc.gov/nchs/nhanes/about_nhanes.htm">National Health and Nutrition Examination Survey (NHANES)</a>. By searching through variable names in the <a href="https://wwwn.cdc.gov/nchs/nhanes/search/default.aspx">NHANES codebook</a>, I found that both testosterone and estradiol were measured in males and females ages 6 and up during <a href="https://wwwn.cdc.gov/Nchs/Nhanes/2013-2014/TST_H.htm">2013-2014</a> and <a href="https://wwwn.cdc.gov/Nchs/Nhanes/2015-2016/TST_I.htm">2015-2016</a> collection cycles. I also imported corresponding <a href="https://wwwn.cdc.gov/nchs/nhanes/2013-2014/demo_h.htm">demographic</a>, <a href="https://wwwn.cdc.gov/Nchs/Nhanes/2013-2014/BMX_H.htm">BMI</a> and <a href="https://wwwn.cdc.gov/Nchs/Nhanes/2013-2014/RHQ_H.htm">health data</a> and merged by SEQN (participant identification number).</p>
<pre class="r"><code>#I utilized the following packages for this project.
pkgs</code></pre>
<pre><code>##  [1] &quot;nhanesA&quot;     &quot;tidyverse&quot;   &quot;magrittr&quot;    &quot;knitr&quot;       &quot;patchwork&quot;  
##  [6] &quot;ggpubr&quot;      &quot;scales&quot;      &quot;brms&quot;        &quot;mgcv&quot;        &quot;sjlabelled&quot; 
## [11] &quot;schoenberg&quot;  &quot;tidymv&quot;      &quot;broom&quot;       &quot;broom.mixed&quot; &quot;tidybayes&quot;  
## [16] &quot;calecopal&quot;</code></pre>
<pre class="r"><code>#Structure of initial, merged dataframe
str(PAdf1)</code></pre>
<pre><code>## &#39;data.frame&#39;:    13144 obs. of  9 variables:
##  $ Testosterone: num  355.03 175.45 447 2.51 206.57 ...
##  $ Test.cc     : int  0 0 0 0 0 0 0 0 0 0 ...
##  $ Estradiol   : num  14.8 14 26.5 2.12 22.3 ...
##  $ Est.cc      : int  0 0 0 1 0 0 1 0 0 0 ...
##  $ Pregnant    : chr  &quot;No&quot; &quot;No&quot; &quot;No&quot; &quot;No&quot; ...
##  $ Pregnant.Sex: Ord.factor w/ 3 levels &quot;Male&quot;&lt;&quot;NP Female&quot;&lt;..: 1 1 1 1 1 NA NA 1 NA 1 ...
##  $ Age         : int  69 54 72 9 56 61 56 65 26 76 ...
##  $ Sex         : Ord.factor w/ 2 levels &quot;Male&quot;&lt;&quot;Female&quot;: 1 1 1 1 1 2 2 1 2 1 ...
##  $ BMI         : num  26.7 28.6 28.9 17.1 41.7 35.7 26.5 22 20.3 34.4 ...</code></pre>
<p><font size="4"> Checking assumptions of normality </font size="4"></p>
<p>By plotting histograms of the initial raw data, it’s clear that there is a lot of variance in estradiol and testosterone values. <img src="ProjectA_files/figure-html/unnamed-chunk-4-1.png" width="576" style="display: block; margin: auto auto auto 0;" /></p>
<p>Based on visual inspection of the plots above, it appears like there could be excess zero-values in this dataset. However, a quick check indicates that there are none.</p>
<pre class="r"><code>sum(PAdf2$Value==0,na.rm = T)</code></pre>
<pre><code>## [1] 0</code></pre>
<p>Since there are no zero-values in this data set, I can log transform raw estradiol and testosterone values. Based on the plot below, things are looking much better! But there are still super low values, which don’t make very much biological sense. <img src="ProjectA_files/figure-html/unnamed-chunk-6-1.png" width="576" style="display: block; margin: auto auto auto 0;" /></p>
<p>A closer evaluation of the <a href="https://wwwn.cdc.gov/Nchs/Nhanes/2013-2014/TST_H.htm">NHANES data file</a> shows that these non-zero lower-than-expected values are likely <strong>imputed values</strong> that were generated for individuals who had assay results below the limit of detection.</p>
<p><img src="Imputed%20values.png" style="width:65.0%" /></p>
<p>Since these imputed values reflect limits of assay sensitivity rather than biological reality, I remove these values from the data set and re-plot log-transformed estradiol and testosterone distributions. These look much better, but there are clearly still some “extreme” values (especially for estradiol). <img src="ProjectA_files/figure-html/unnamed-chunk-7-1.png" width="576" style="display: block; margin: auto auto auto 0;" /></p>
<p>Another consideration is how pregnancy status among females may impact hormone levels, since biological knowledge suggests that estradiol is likely to be much higher during pregnancy. A quick check indicates that there are 112 pregnant females in this sample.</p>
<pre class="r"><code>table(PAdf3$Pregnant.Sex)</code></pre>
<pre><code>## 
##      Male NP female  P female 
##     12188      9558       112</code></pre>
<p>The plot below gives an idea of how pregnancy status may be driving “extreme” values. <img src="ProjectA_files/figure-html/unnamed-chunk-9-1.png" width="576" style="display: block; margin: auto auto auto 0;" /></p>
<p><img src="ProjectA_files/figure-html/unnamed-chunk-10-1.png" width="576" style="display: block; margin: auto auto auto 0;" /></p>
<p><img src="ProjectA_files/figure-html/unnamed-chunk-11-1.png" width="576" style="display: block; margin: auto auto auto 0;" /></p>
</div>




</div>

<script>

// add bootstrap table styles to pandoc tables
function bootstrapStylePandocTables() {
  $('tr.odd').parent('tbody').parent('table').addClass('table table-condensed');
}
$(document).ready(function () {
  bootstrapStylePandocTables();
});


</script>

<!-- tabsets -->

<script>
$(document).ready(function () {
  window.buildTabsets("TOC");
});

$(document).ready(function () {
  $('.tabset-dropdown > .nav-tabs > li').click(function () {
    $(this).parent().toggleClass('nav-tabs-open');
  });
});
</script>

<!-- code folding -->


<!-- dynamically load mathjax for compatibility with self-contained -->
<script>
  (function () {
    var script = document.createElement("script");
    script.type = "text/javascript";
    script.src  = "https://mathjax.rstudio.com/latest/MathJax.js?config=TeX-AMS-MML_HTMLorMML";
    document.getElementsByTagName("head")[0].appendChild(script);
  })();
</script>

</body>
</html>
